@import (reference) '../base/variables.less';
@import (reference) '../base/mixins.less';

// Основная секция
.main {
    padding: @spacing-gap 0;
}

.main-container {
    max-width: @content-max-width;
    margin: 0 auto;
    padding: 0 @spacing-xl;
}

.section-title {
    .text-center();
    margin-bottom: 40px;
    font-size: @font-size-xxl;
    color: @primary-color;
}

.products-grid {
    flex: 1;
    min-width: 0; // Позволяет сжиматься в flex контейнере
    overflow: hidden;
    max-width: 100%; // Предотвращаем переполнение
    position: relative;
    z-index: 1; // Ниже кнопок
}

// Обертка карусели
.carousel-wrapper {
    width: 100%;
    overflow: hidden;
    position: relative;
    display: block;
    padding: 0; // Убеждаемся, что нет padding, который может влиять на расчеты
    box-sizing: border-box;
    // Убеждаемся, что wrapper не выходит за границы
    max-width: 100%;
    // Предотвращаем переполнение карточек за границы
    clip-path: inset(0);
}

// Контейнер карточек в карусели
.carousel-cards {
    display: flex;
    will-change: transform;
    gap: @spacing-xxxl;
    flex-wrap: nowrap;
    padding: 0;
    margin: 0;
    // Контейнер автоматически расширяется для размещения всех карточек
    // Ширина определяется количеством карточек
}

.product-card {
    .product-card();
    // Ширина устанавливается через JavaScript для точного расчета
    // CSS используется как fallback
    min-width: 0;
    box-sizing: border-box;
    flex-shrink: 0;
}

.product-card:hover {
    transform: translateY(-5px);
}

.product-image {
    .product-image();
}

.product-image img {
    max-width: 100%;
    max-height: 100px;
}

.product-title {
    font-size: @font-size-lg;
    font-weight: bold;
    margin-bottom: @spacing-sm;
    color: @gray-dark;
}

.product-brand {
    color: @gray-medium;
    font-size: @font-size-md;
    margin-bottom: @spacing-sm;
}

.product-price {
    font-size: @font-size-xl;
    font-weight: bold;
    color: @black;
    margin-bottom: @spacing-md;
}

.product-availability {
    .availability-status(@success-color);

    &.in-stock {
        color: @success-color;
        
        .availability-dot {
            background: @success-color;
        }
    }
    
    &.out-of-stock {
        color: @warning-color;
        
        .availability-dot {
            background: @warning-color;
        }
    }
}

.product-btn {
    width: 100%;
    padding: @spacing-md;
    .button-style();
    font-weight: bold;
    
    &.btn-out-of-stock {
        .button-disabled();
    }
}

// Карусель
.carousel-container {
    position: relative;
    display: flex;
    align-items: center;
    width: 100%;
    overflow: visible; // Разрешаем видимость для кнопок
}

.carousel-btn {
    position: absolute;
    top: 50%;
    transform: translateY(-50%);
    flex-shrink: 0; 
    z-index: @z-index-dots + 1;
    .carousel-button();
    // Убеждаемся, что кнопки не сжимаются
    min-width: @carousel-btn-size;
    width: @carousel-btn-size;
    height: @carousel-btn-size;
    
    &.prev {
        left: @spacing-xl;
    }
    
    &.next {
        right: @spacing-xl;
    }
    
    &.disabled {
        opacity: 0.5;
        cursor: not-allowed;
        
        &:hover {
            background: fade(@disabled-color, 50%);
            transform: translateY(-50%);
            box-shadow: none;
        }
    }
}

// Responsive стили для карточек
.breakpoint(1200px; {
    .main-container {
        max-width: 100%;
        padding: 0 @spacing-lg;
    }
    
    // Ширина карточек устанавливается через JavaScript
});

.breakpoint(992px; {
    .main {
        padding: @spacing-xxxxl 0;
    }
    
    .section-title {
        font-size: @font-size-xl;
        margin-bottom: @spacing-xxxxl;
    }
    
    .product-card {
        // Ширина устанавливается через JavaScript
        padding: @spacing-xl;
    }
    
    .carousel-cards {
        gap: @spacing-xl;
    }
});

.breakpoint(768px; {
    .main {
        padding: @spacing-xxxl 0;
    }
    
    .main-container {
        padding: 0 @spacing-md;
    }
    
    .section-title {
        font-size: @font-size-lg;
        margin-bottom: @spacing-xxxl;
    }
    
    .product-card {
        // Ширина устанавливается через JavaScript
        padding: @spacing-lg;
    }
    
    .carousel-cards {
        gap: @spacing-lg;
    }
    
    .product-title {
        font-size: @font-size-md;
    }
    
    .product-brand {
        font-size: @font-size-sm;
    }
    
    .product-price {
        font-size: @font-size-lg;
    }
    
    .carousel-btn {
        &.prev {
            left: @spacing-md;
        }
        
        &.next {
            right: @spacing-md;
        }
        
        .icon-size(35px);
    }
});

.breakpoint(480px; {
    .main {
        padding: @spacing-xxl 0;
    }
    
    .section-title {
        font-size: @font-size-lg;
        margin-bottom: @spacing-xxl;
    }
    
    .product-card {
        // Ширина устанавливается через JavaScript
        padding: @spacing-md;
    }
    
    .carousel-cards {
        gap: @spacing-md;
    }
    
    .product-image {
        height: 100px;
    }
    
    .product-image img {
        max-height: 80px;
    }
    
    .carousel-btn {
        &.prev {
            left: @spacing-sm;
        }
        
        &.next {
            right: @spacing-sm;
        }
        
        .icon-size(30px);
    }
});